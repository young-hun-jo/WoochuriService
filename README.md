# ğŸ® ìš°ì¶”ë¦¬ ì¶•ì‚° ì¼ì¼ ë§¤ì¶œ ì˜ˆì¸¡ í”„ë¡œì íŠ¸ ğŸ·

## ğŸ¯ í”„ë¡œì íŠ¸ ëª©ì 
- ëŒ€ì „ê´‘ì—­ì‹œ ì„œêµ¬ ë„í™”ê³µì›ê¸¸ 21ì— ìœ„ì¹˜í•œ ìš°ì¶”ë¦¬ ì¶•ì‚°
- 2020ë…„ 2ì›” ì´í›„ë¡œ ì„¸ê³„ì ìœ¼ë¡œ í™•ì‚°ëœ ì½”ë¡œë‚˜ ì‹ ì¢… ë°”ì´ëŸ¬ìŠ¤ë¡œ ì¸í•´ ë§¤ì¶œì˜ íƒ€ê²©ì— í° ì˜í–¥ì„ ì…ê²Œ ëœ ìƒíƒœ
- ë¨¸ì‹  ëŸ¬ë‹ì„ í™œìš©í•˜ì—¬ **ì¼ì¼ ë§¤ì¶œì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì˜ˆì¸¡**í•´ ì •ìœ¡ ì¬ê³  ê´€ë¦¬ë¥¼ ìµœì í™”í•˜ê³  ìµœì¢…ì ìœ¼ë¡œ **ìš´ì˜ ë¹„ìš© ìµœì†Œí™” ëª©ì **

## ğŸ“‹ ë°ì´í„° ëª…ì„¸ì„œ
- *ìš°ì¶”ë¦¬ ì¶•ì‚° ì¼ ë§¤ì¶œ ë°ì´í„°*
  * ì˜ì—… ì˜¤í”ˆì¼ 2009-01-01 ~ í˜„ì¬ ê¹Œì§€ì˜ ì¼ ë§¤ì¶œ ë°ì´í„°
  * Excel í™œìš©í•´ ìˆ˜ê¸°ë¡œ ì§ì ‘ ìˆ˜ì§‘
 
- *ì§€ìƒ(ì¢…ê´€, ASOS) ì¼ìë£Œ ì¡°íšŒ ì„œë¹„ìŠ¤*
  * ê³µê³µ ë°ì´í„° [Open API](https://www.data.go.kr/tcs/dss/selectApiDataDetailView.do?publicDataPk=15059093)
  * í‰ê· ê¸°ì˜¨
  * ìµœì €ê¸°ì˜¨
  * ìµœê³ ê¸°ì˜¨
  * 1ì‹œê°„ ìµœë‹¤ê°•ìˆ˜ëŸ‰
  * ì¼ ê°•ìˆ˜ëŸ‰
  * í‰ê· í’ì†
  * ìµœëŒ€í’ì†
  * í‰ê· ìƒëŒ€ìŠµë„
  * ìµœì†ŒìƒëŒ€ìŠµë„
  * 1ì‹œê°„ ìµœë‹¤ì¼ì‚¬ëŸ‰
  * ì¼ì‚¬ëŸ‰
 
- *ì¶•ì‚°ë¬¼ë“±ê¸‰íŒì • ì„œë¹„ìŠ¤*
  * ê³µê³µ ë°ì´í„° [Open API](https://www.data.go.kr/tcs/dss/selectApiDataDetailView.do?publicDataPk=15058822)
  * í•œìš°ì™€ ìœ¡ìš° ë„ë§¤ ê°€ê²©
    - 2009-01-01~2011-03-02 ê¹Œì§€ëŠ” ì „êµ­ ë„ë§¤ ê°€ê²© 
    - 2011-03-03~í˜„ì¬ ê¹Œì§€ëŠ” ì¤‘ë¶€ê¶Œ ë„ë§¤ ê°€ê²©(ëŒ€ì „ì´ ì¤‘ë¶€ê¶Œì— ì†í•¨)
  * ë¼ì§€ íƒ•ë°• ë„ë§¤ ê°€ê²©
    - ë¼ì§€ ë°•í”¼ ë„ë§¤ ê°€ê²©ë„ ìˆì—ˆìœ¼ë‚˜ í˜„ì¬ ë¼ì§€ê³ ê¸°ì˜ ì•½ 97%ê°€ ë¼ì§€ íƒ•ë°•ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë°•í”¼ ë°ì´í„°ëŠ” ì œì™¸
    - [ë¼ì§€ íƒ•ë°•ê³¼ ë¼ì§€ ë°•í”¼ì˜ ì°¨ì´ì ](https://m.blog.naver.com/PostView.nhn?blogId=dsf-mall&logNo=221503684858&proxyReferer=https:%2F%2Fwww.google.com%2F)

## ğŸ›  ë°ì´í„° ì „ì²˜ë¦¬
- ê²°ì¸¡ì¹˜
  * ì§€ìƒ(ì¢…ê´€, ASOS) ì¼ìë£Œ ë°ì´í„°
    - í•´ë‹¹ ë°ì´í„° ë³€ìˆ˜ë“¤ì€ ì„œë¡œ ìƒê´€ì„±ì´ ë†’ê¸° ë•Œë¬¸ì— Pearson Correlationì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ì—¬ [KNN(K-Nearest-Neighbors) Imputer](https://scikit-learn.org/stable/modules/generated/sklearn.impute.KNNImputer.html) ì‚¬ìš©
    
- ì´ìƒì¹˜
  * í•œìš°ì™€ ìœ¡ìš° ë„ë§¤ ê°€ê²©
    - [í•œìš° ê°€ê²©ì€ ìœ¡ìš° ê°€ê²©ì˜ ì•½ 1.8ë°°](https://www.google.com/search?q=%EC%9C%A1%EC%9A%B0+%ED%95%9C%EC%9A%B0+%EA%B0%80%EA%B2%A9%EC%B0%A8%EC%9D%B4&oq=%ED%95%9C%EC%9A%B0+%EC%9C%A1%EC%9A%B0&aqs=chrome.4.69i57j69i59j35i39j0i8i30l4j69i61.3516j0j4&sourceid=chrome&ie=UTF-8)ë¡œ ì±…ì •. ì´ë¥¼ ì´ìš©í•´ ë¡œì§ êµ¬í˜„
    - í•œìš° ê°€ê²©ì´ ì˜ëª» ì±…ì •ëœ ë‚ ì§œì¼ ê²½ìš° â¡ï¸ í•´ë‹¹ ë‚ ì§œì˜ ìœ¡ìš°ê°€ê²©ì„ ì´ìš©í•´ ì´ìƒì¹˜ ëŒ€ì²´
    - ìœ¡ìš° ê°€ê²©ì´ ì˜ëª» ì±…ì •ëœ ë‚ ì§œì¼ ê²½ìš° â¡ï¸ í•´ë‹¹ ë‚ ì§œì˜ í•œìš°ê°€ê²©ì„ ì´ìš©í•´ ì´ìƒì¹˜ ëŒ€ì²´
 
 - ëª…ì ˆ, ê³µíœ´ì¼ íŒŒìƒë³€ìˆ˜ ìƒì„±
  * ì„¤, ì¶”ì„ ëª…ì ˆ
    - ìš°ì¶”ë¦¬ ì¶•ì‚°ì€ í•­ìƒ ëª…ì ˆ ë‹¹ì¼ ì§ì „ë‚ ê¹Œì§€ ì˜ì—… ê²Œì‹œ
    - EDA ê²°ê³¼, ëª…ì ˆ ì´ë²¤íŠ¸ë¡œ ì¸í•´ ëª…ì ˆ ë‹¹ì¼ ì§ì „ë‚ ë¡œë¶€í„° ê³¼ê±° 6ì¼ê°„ ë§¤ì¶œì´ í‰ì†Œì™€ ë‹¤ë¥´ê²Œ ë§¤ìš° ë†’ì€ ê²ƒìœ¼ë¡œ ê´€ì°°
    - [holidays](https://pypi.org/project/holidays/) ì˜¤í”ˆì†ŒìŠ¤ë¥¼ ì´ìš©í•´ ëŒ€í•œë¯¼êµ­ì˜ ëª…ì ˆ ë°ì´í„°ë¥¼ ë¯¸ë¦¬ ë¡œë“œí•˜ê³  í•´ë‹¹ ë‚ ì§œë¡œë¶€í„° ë¯¸ë˜ 6ì¼ ì´ë‚´ì— ëª…ì ˆ ë‹¹ì¼ ì§ì „ë‚ ì´ ì¡´ì¬í•˜ë©´ ê°€ì¤‘ì¹˜ë¥¼ 1ë¶€í„° 6ê¹Œì§€ ì°¨ë“±ì ìœ¼ë¡œ ë¶€ì—¬
      - ìœ„ì™€ ê°™ì€ ë¡œì§ì„ ì‚¬ìš©í•´ ì‹¤ì‹œê°„ ë‚ ì§œì— ëª…ì ˆ ì—°íœ´ ê°€ì¤‘ì¹˜ë¥¼ ë¶€ì—¬í•  ìˆ˜ ìˆìŒ
  
  * ì¼ë°˜ ê³µíœ´ì¼
    - ì–´ë¦°ì´ë‚ , ì„ê°€íƒ„ì‹ ì¼ ë“±ê³¼ ê°™ì´ ì¼ë°˜ ê³µíœ´ì¼ì—ë„ í‰ì†Œì™€ ë‹¤ë¥´ê²Œ ë†’ì€ ë§¤ì¶œì´ ì§‘ê³„
    - ëª…ì ˆê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ë™ì¼í•œ ë¡œì§ êµ¬í˜„

## ğŸ¦¾ ì˜ˆì¸¡ ëª¨ë¸ ì„±ëŠ¥ ë¹„êµ
- ``Train`` : 2009-01-01 ~ 2019-12-31
- ``Validation`` : 2020-01-01 ~ 2020-12-31(1ì¼ì”© êµì°¨ê²€ì¦ ìˆ˜í–‰)
- ``Accuracy``: ì˜¤ì°¨(MAE)ê°€ 10ë§Œì› ì´í•˜ë¡œ ì˜ˆì¸¡í–ˆìœ¼ë©´ ì„±ê³µ(1), ì•„ë‹ˆë©´ ì‹¤íŒ¨(0)ë¡œ ê³„ì‚°í•˜ì—¬ ì˜ˆì¸¡ ì •í™•ë„ ì„±ëŠ¥ ê³„ì‚°

|Model|Train MAPE|Test MAPE|
|---|---|---|---|
|[Prophet](https://facebook.github.io/prophet/)|X|400,000|
|ARIMA|X|400,000|
|Linear Regression|280,000|280,000|
|Polynomial Linear Regression(2 degree)|230,000|250,000|
|PLS Regression|290,000|290,000|
|Random Forest|70,000|190,000|
|XGBoost|150,000|200,000|
|LightGBM|140,000|220,000|
|LightGBM(PCAë¡œ ì°¨ì›ì¶•ì†Œ )|180,000|270,000|
|Hybrid Voting(Random Forest+XGBoost+LightGBM)|120,000|200,000|
|LSTM(with Convolution)|336,000|260,000|

ğŸ’¡ ìµœì¢… ëª¨ë¸ : **Random Forest Regressor**<br>
ğŸ’¡ Optimal Hyper-parameter : ``n_estimators=100``, ``min_samples_split=2``<br>
ğŸ’¡ ì•ìœ¼ë¡œ ì¼ì¼ ë°ì´í„°ë¥¼ ê³„ì† ìˆ˜ì§‘ í›„ í•™ìŠµí•  ê²ƒì´ë¯€ë¡œ Train MAEê°€ ê°€ì¥ ë‚®ì€ Random Forest ì„ ì •<br><br>
ğŸ§· ìµœì¢… ëª¨ë¸ ì˜ˆì¸¡ ê·¸ë˜í”„(**2009-01-01 ~ 2021-04-18**)<br>
<img width="745" alt="eval_res" src="https://user-images.githubusercontent.com/54783194/115231708-d3ee5680-a150-11eb-852c-f6f54aec7903.png">

## ğŸ“Š ë¶„ì„ê²°ê³¼ ë³´ê³ ì„œ ì‘ì„±
- [Notion](https://www.notion.so/4f3cf41bc515438095b3a79be8bc5f9d)

## ğŸ“Ÿ ìë™í™”
- ì˜ˆì¸¡í•˜ê¸° ì „ ì „ì¼ ìš°ì¶”ë¦¬ ì¶•ì‚° ë§¤ì¶œê³¼ íœ´ë¬´ ì—¬ë¶€ë¥¼ ``today_sale`` ë³€ìˆ˜ì™€ ``remark_str``ì— ì…ë ¥
- ì˜ˆì¸¡í•˜ë ¤ëŠ” ë‚  ì˜¤ì „ 8ì‹œ, ì˜¤ì „ 11ì‹œì— 2ì°¨ë¡€ ``main.py`` ìˆ˜í–‰
- ìœ ë‹‰ìŠ¤ ê³„ì—´ Mac OS ì‹œê°„ ê¸°ë°˜ ì¡ ìŠ¤ì¼€ì¤„ëŸ¬ [cron](https://www.letmecompile.com/scheduler-cron-tutorial/) ì´ìš©
- ì˜ˆì¸¡ê°’ì„ SMSë¡œ ì „ë‹¬í•˜ê¸° ìœ„í•´ ì†Œì •ì˜ ìœ ë£Œ SMS ë°œì†¡ í”Œë«í¼ [twiliow](https://www.twilio.com/) í™œìš©
```
import pandas as pd
from weather import CrawlWeather
from beef_pork import CrawlPrices
from Woochuri_sales import InsertSale
from model import WoochuriPredModel
from twilio.rest import Client

print(pd.Timestamp.now())
# Crawling today's weather dataset in Public data API and store it in local DB
crawling_weather = CrawlWeather()
crawling_weather.crawl_weather()

# Crawling today's beef, pork price dataset in Public data API and store it in local DB
crawling_prices = CrawlPrices()
crawling_prices.crawl_beef()  # Beef price
crawling_prices.crawl_pork()  # Pork price

# Insert today's sales of Woochuri store and store it in local DB
today_sale = 435700  # ê¸ˆì¼ ë§¤ì¶œ ì…ë ¥í•˜ê¸°
remark_str = 'í‰ì¼'  # ê¸ˆì¼ íœ´ë¬´ ì—¬ë¶€ ì…ë ¥í•˜ê¸°!
insert_sale = InsertSale()
insert_sale.insert_sale(today_sale=today_sale, remark_str=remark_str)

# Load updated crawling dataset and modeling to predict tomorrow's sale
# Setting parameters using local MySQL id, password
user, password = 'root', 'watson1259@'
end_time = (pd.Timestamp.now() - pd.Timedelta(days=1)).strftime("%Y-%m-%d")

PredModel = WoochuriPredModel(user=user, password=password, end_time=end_time)
FinalDataset = PredModel.execute()
result = PredModel.run(FinalDataset)

# # Sending Meassage
account_sid = 'AC8f9d9f4c8983ee648153f5347ee027a9'
auth_token = 'your_auth_token' # your_auth_token ë”°ë¡œ ì ì–´ë†“ê¸°
client = Client(account_sid, auth_token)

woochuri_master = '+821094125854'
message = client.messages.create(from_='+13132543287', body=result, to=woochuri_master)
print(message.sid)
```

## âš™ï¸ Stack
<img width="639" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-03-29 á„‹á…©á„’á…® 5 09 47" src="https://user-images.githubusercontent.com/54783194/112806291-95193380-90b1-11eb-9e6a-2b4934ea0080.png"><br>
- Python 3.7.7
- BeautifulSoup 4.6.0
- MySQL 8.0.21(pymysql 1.0.2)
- Pandas
- Numpy
- Scikit-learn 0.24.1
- Tensorflow 2.x
- PowerPoint
- IDE: PyCharm, Jupyter notebook

## ğŸ“Œ [twiliow ì‚¬ìš©ë²•](https://pypi.org/project/twilio/)
- ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ í„°ë¯¸ë„ì—ì„œ ì…ë ¥ í›„ ë‹¤ìš´ë¡œë“œ
<br>```pip install twilio```<br>
- twilio ê°€ì… í›„ twilio ì›¹ ë¸Œë¼ìš°ì € consoleë¡œ ì´ë™í•´ ``account_sid``ì™€ ``auth_token`` í™•ì¸ í›„ ``main.py`` íŒŒì¼ê³¼ ë™ì¼í•œ ì½”ë“œë¡œ ë©”ì„¸ì§€ ì „ì†¡
